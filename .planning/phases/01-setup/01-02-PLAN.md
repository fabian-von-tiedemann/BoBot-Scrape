---
phase: 01-setup
plan: 02
type: execute
depends_on: ["01-01"]
files_modified: [scrape.py]
---

<objective>
Create Python script that connects to running Chrome via CDP and navigates to the target intranet page.

Purpose: Establish the core connection mechanism that all subsequent scraping will depend on.
Output: Working scrape.py that can connect to Chrome and navigate to the intranet start page.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./.claude/get-shit-done/templates/summary.md
./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-setup/01-CONTEXT.md
@.planning/phases/01-setup/01-01-SUMMARY.md

**Target URL:** https://botwebb.botkyrka.se/sidor/din-forvaltning/forvaltningar/vard--och-omsorgsforvaltningen/kvalitet/lagar-termer-och-styrdokument/styrdokument/rutiner-for-utforare.html

**Playwright CDP API:**
```python
browser = playwright.chromium.connect_over_cdp("http://localhost:9222")
context = browser.contexts[0]
page = context.pages[0]  # or context.new_page()
```

**Chrome must be started with:**
```bash
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222
```

**Key constraints from CONTEXT.md:**
- Reliable connection - fail cleanly if Chrome isn't running
- Minimal scope - just connect and navigate, no scraping yet
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CDP connection script</name>
  <files>scrape.py</files>
  <action>
Create scrape.py with:

1. Connect to Chrome at http://localhost:9222 using connect_over_cdp
2. Get the default browser context (browser.contexts[0])
3. Either use existing page or create new page
4. Navigate to the target URL
5. Wait for page to load (wait_for_load_state)
6. Print page title as confirmation
7. Keep browser open (don't close) - we're reusing user's session

Use sync_playwright API (simpler for a script).

Error handling:
- Catch connection errors and print helpful message: "Chrome not running with --remote-debugging-port=9222"
- Exit cleanly on errors

Script should be runnable as: .venv/bin/python scrape.py
  </action>
  <verify>cat scrape.py shows connect_over_cdp usage and target URL navigation</verify>
  <done>scrape.py exists with CDP connection and navigation logic</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>CDP connection script that navigates to intranet page</what-built>
  <how-to-verify>
    1. Start Chrome with remote debugging:
       /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome --remote-debugging-port=9222
    2. In Chrome: Log in to Botkyrka intranet if not already
    3. Run the script:
       .venv/bin/python scrape.py
    4. Confirm: Script connects and navigates to the rutiner page
    5. Confirm: Page title is printed (should be something like "Rutiner för utförare")
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] scrape.py exists and runs without syntax errors
- [ ] Script connects to Chrome via CDP
- [ ] Script navigates to target URL
- [ ] Human verified: actual connection and navigation works
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Human approved CDP connection works
- Phase 1 complete
</success_criteria>

<output>
After completion, create `.planning/phases/01-setup/01-02-SUMMARY.md`
</output>
