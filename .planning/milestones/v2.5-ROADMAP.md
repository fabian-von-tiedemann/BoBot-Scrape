# Milestone v2.5: System Prompt Generation

**Status:** ✅ SHIPPED 2026-01-14
**Phases:** 19-21
**Total Plans:** 3

## Overview

Generera skräddarsydda systemprompts per verksamhet/område baserat på dokumentinnehåll för AI-assistenten.

## Phases

### Phase 19: Frontmatter Indexer

**Goal**: Extrahera frontmatter från alla markdown-filer per mapp och skapa index-dokument
**Depends on**: Previous milestone complete
**Plans**: 1/1 complete

Plans:
- [x] 19-01: Create frontmatter indexer and KB indexer CLI — completed 2026-01-14

**Details:**
- Created `src/indexer.py` with extract_frontmatter(), index_folder(), FolderIndex dataclass
- Created `index_kb.py` CLI with --input and --output options
- Generated 15 verksamhet-specific index files
- Indexed 1,086 documents total

### Phase 20: System Prompt Generator

**Goal**: Generera verksamhet-specifika systemprompts med Gemini baserat på index-dokumenten
**Depends on**: Phase 19
**Plans**: 1/1 complete

Plans:
- [x] 20-01: Create system prompt generator module and CLI — completed 2026-01-14

**Details:**
- Created `src/prompt_generator.py` with SystemPrompt Pydantic model
- Created `generate_prompts.py` CLI for batch prompt generation
- Generated 15 verksamhet-specific system prompts in `prompts/`
- Each prompt contains Swedish introduction, key areas, document types, AI guidance

### Phase 21: General Prompt Template

**Goal**: Skapa generell systemprompt-del som gäller alla enheter + kombinera med verksamhet-specifika delar
**Depends on**: Phase 20
**Plans**: 1/1 complete

Plans:
- [x] 21-01: Create general system prompt template and combiner — completed 2026-01-14

**Details:**
- Created `prompts/GENERAL.md` with 6 sections: Identitet, Uppgift, Tonalitet, Principer, Språk, Format
- Created `src/prompt_combiner.py` module with load/combine/write functions
- Created `combine_prompts.py` CLI
- Generated 15 combined prompts in `prompts/combined/`

---

## Milestone Summary

**Key Decisions:**
- Used same Gemini pattern as src/ai/gemini.py for consistency
- Structured output via Pydantic model for predictable prompt format
- General prompt in Swedish with standardized 6 sections
- Combined prompts use `---` separator between general and specific content

**Issues Resolved:**
- google-genai not installed for Python 3.13 → installed to correct Python

**Issues Deferred:**
- None

**Technical Debt Incurred:**
- None

---

*For current project status, see .planning/ROADMAP.md*
